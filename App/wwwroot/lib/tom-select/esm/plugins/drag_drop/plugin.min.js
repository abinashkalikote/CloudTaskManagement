const preventDefault=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},addEvent=(e,t,r,n)=>{e.addEventListener(t,r,n)},accent_pat="[̀-ͯ·ʾʼ]",latin_convert={},latin_condensed={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let n in latin_condensed){let r=latin_condensed[n]||"";for(let t=0;t<r.length;t++){let e=r.substring(t,t+1);latin_convert[e]=n}}new RegExp(Object.keys(latin_convert).join("|")+"|"+accent_pat,"gu");const iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)},getDom=e=>{return e.jquery?e[0]:e instanceof HTMLElement?e:isHtmlString(e)?((t=document.createElement("template")).innerHTML=e.trim(),t.content.firstChild):document.querySelector(e);var t},isHtmlString=e=>"string"==typeof e&&-1<e.indexOf("<"),setAttr=(r,e)=>{iterate(e,(e,t)=>{null==e?r.removeAttribute(t):r.setAttribute(t,""+e)})},insertAfter=(e,t)=>{var r;null!=(r=e.parentNode)&&r.insertBefore(t,e.nextSibling)},insertBefore=(e,t)=>{var r;null!=(r=e.parentNode)&&r.insertBefore(t,e)},isBefore=(e,t)=>{do{if(e==(t=null==t?void 0:t.previousElementSibling))return!0}while(t&&t.previousElementSibling);return!1};function plugin(){var i=this;if("multi"===i.settings.mode){var e=i.lock,t=i.unlock;let o=!0,s;i.hook("after","setupTemplates",()=>{var a=i.settings.render.item;i.settings.render.item=(e,t)=>{const r=getDom(a.call(i,e,t));setAttr(r,{draggable:"true"});e=e=>{e.preventDefault(),r.classList.add("ts-drag-over"),n(r,s)};const n=(e,t)=>{void 0!==t&&(isBefore(t,r)?insertAfter:insertBefore)(e,t)};return addEvent(r,"mousedown",e=>{o||preventDefault(e),e.stopPropagation()}),addEvent(r,"dragstart",e=>{s=r,setTimeout(()=>{r.classList.add("ts-dragging")},0)}),addEvent(r,"dragenter",e),addEvent(r,"dragover",e),addEvent(r,"dragleave",()=>{r.classList.remove("ts-drag-over")}),addEvent(r,"dragend",()=>{document.querySelectorAll(".ts-drag-over").forEach(e=>e.classList.remove("ts-drag-over")),null!=(e=s)&&e.classList.remove("ts-dragging"),s=void 0;var e,t=[];i.control.querySelectorAll("[data-value]").forEach(e=>{e.dataset.value&&(e=e.dataset.value)&&t.push(e)}),i.setValue(t)}),r}}),i.hook("instead","lock",()=>(o=!1,e.call(i))),i.hook("instead","unlock",()=>(o=!0,t.call(i)))}}export{plugin as default};