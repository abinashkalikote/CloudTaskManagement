!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).caret_position=t()}(this,function(){"use strict";const o={};var r,e={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(r in e){let t=e[r]||"";for(let e=0;e<t.length;e++){var n=t.substring(e,e+1);o[n]=r}}new RegExp(Object.keys(o).join("|")+"|[̀-ͯ·ʾʼ]","gu");const i=e=>{var t=[],o=e,r=e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))};if(Array.isArray(o))o.forEach(r);else for(var n in o)o.hasOwnProperty(n)&&r(o[n],n);return t.filter(Boolean)},a=e=>e=Array.isArray(e)?e:[e];return function(){var n=this;n.hook("instead","setCaret",o=>{"single"!==n.settings.mode&&n.control.contains(n.control_input)?(o=Math.max(0,Math.min(n.items.length,o)))==n.caretPos||n.isPending||n.controlChildren().forEach((e,t)=>{t<o?n.control_input.insertAdjacentElement("beforebegin",e):n.control.appendChild(e)}):o=n.items.length,n.caretPos=o}),n.hook("instead","moveCaret",e=>{var t,o,r;n.isFocused&&((o=n.getLastActive(e))?(t=((e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var o=0;e=e.previousElementSibling;)e.matches(t)&&o++;return o})(o),n.setCaret(0<e?t+1:t),n.setActiveItem(),t=o,o=["last-active"],r=i(o),(t=a(t)).map(t=>{r.map(e=>{t.classList.remove(e)})})):n.setCaret(n.caretPos+e))})}});